{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('admin.static', filename='admin.css') }}">
{% endblock %}

{% block body %}
<div class="navbar bg-base-100 shadow-lg">
    <div class="flex-1">
        <span class="text-xl font-bold px-4">Interactive Gym Admin</span>
    </div>
    <div class="flex-none">
        <div class="badge badge-success badge-outline mr-4 live-indicator" id="connection-status">
            Connecting...
        </div>
        <a href="{{ url_for('admin.logout') }}" class="btn btn-ghost btn-sm">
            Logout
        </a>
    </div>
</div>

<div class="container mx-auto p-6">
    <!-- Stats overview -->
    <div class="stats shadow w-full mb-6 bg-base-100">
        <div class="stat">
            <div class="stat-title">Active Participants</div>
            <div class="stat-value" id="stat-participants">-</div>
            <div class="stat-desc">Currently connected</div>
        </div>
        <div class="stat">
            <div class="stat-title">Active Games</div>
            <div class="stat-value" id="stat-games">-</div>
            <div class="stat-desc">In progress</div>
        </div>
        <div class="stat">
            <div class="stat-title">Waiting Room</div>
            <div class="stat-value" id="stat-waiting">-</div>
            <div class="stat-desc">Participants waiting</div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Participants Table (2/3 width on large screens) -->
        <div class="lg:col-span-2">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h2 class="card-title">Participants</h2>

                    <div class="overflow-x-auto">
                        <table class="table table-zebra" id="participants-table">
                            <thead>
                                <tr>
                                    <th>Subject ID</th>
                                    <th>Status</th>
                                    <th>Current Scene</th>
                                    <th>Progress</th>
                                    <th>Last Update</th>
                                </tr>
                            </thead>
                            <tbody id="participants-tbody">
                                <tr>
                                    <td colspan="5" class="text-center text-base-content/50">
                                        Loading...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar (1/3 width on large screens) -->
        <div class="space-y-6">
            <!-- Waiting Rooms -->
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h2 class="card-title text-base">Waiting Rooms</h2>
                    <div id="waiting-rooms-container">
                        <div class="text-center text-base-content/50 py-4">
                            Loading...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Activity Timeline -->
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h2 class="card-title text-base">Activity Timeline</h2>
                    <div id="activity-timeline">
                        <div class="text-center text-base-content/50 py-4">
                            Loading...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('admin.static', filename='admin.js') }}"></script>
{% endblock %}
