---
phase: 70-verification-test-pass
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - interactive_gym/examples/cogrid/scenes/controllable_scenes.py
  - interactive_gym/examples/cogrid/overcooked_controllable_demo.py
  - interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_test.py
  - interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_focus_timeout_test.py
  - interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_multi_episode_test.py
  - interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_scene_isolation_test.py
autonomous: true

must_haves:
  truths:
    - "All example and test config files import without AttributeError"
    - "No references to removed methods (.pyodide(), .user_experience(), .focus_loss_config()) remain in any Python file under interactive_gym/examples/"
    - "assets_to_preload passed to .assets() not .rendering() in controllable_scenes.py"
  artifacts:
    - path: "interactive_gym/examples/cogrid/scenes/controllable_scenes.py"
      provides: "Controllable scene configs using new API exclusively"
      contains: ".content("
    - path: "interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_test.py"
      provides: "Test config using multiplayer() instead of focus_loss_config/pyodide"
      contains: ".multiplayer("
  key_links:
    - from: "interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_test.py"
      to: "interactive_gym/scenes/gym_scene.py"
      via: "method chaining with multiplayer()"
      pattern: "\\.multiplayer\\("
    - from: "interactive_gym/examples/cogrid/scenes/controllable_scenes.py"
      to: "interactive_gym/scenes/gym_scene.py"
      via: "method chaining with content() and runtime()"
      pattern: "\\.(content|runtime)\\("
---

<objective>
Migrate all remaining files that still reference removed GymScene methods to the new API.

Purpose: Phase 69 migrated the 5 main example files but missed the 4 e2e test config files and 2 controllable scene files. These still call `.pyodide()`, `.user_experience()`, and `.focus_loss_config()` which were removed in Phase 68 and will cause AttributeError at import time. Without this migration, e2e tests cannot even start.

Output: All 6 files migrated to exclusively use new API methods. Zero references to removed methods remain in any Python file under `interactive_gym/examples/`.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@interactive_gym/scenes/gym_scene.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate controllable_scenes.py and overcooked_controllable_demo.py</name>
  <files>
    interactive_gym/examples/cogrid/scenes/controllable_scenes.py
    interactive_gym/examples/cogrid/overcooked_controllable_demo.py
  </files>
  <action>
Apply the same migration pattern established in Phase 69 to controllable_scenes.py:

1. Every `.user_experience(...)` call becomes `.content(...)`. The parameter names are identical (scene_header, scene_body, scene_body_filepath, game_page_html_fn, in_game_scene_body, in_game_scene_body_filepath). This is a direct method rename -- no param changes needed.

2. Every `.pyodide(...)` call becomes `.runtime(...)`. The parameter names are identical (run_through_pyodide, environment_initialization_code_filepath, on_game_step_code, packages_to_install). This is a direct method rename -- no param changes needed.

3. The 3 `.rendering(assets_to_preload=...)` calls (around lines 118, 153, 227) need the `assets_to_preload` kwarg removed from `.rendering()` and placed into a separate `.assets(assets_to_preload=...)` call chained after `.rendering()`. The `rendering()` method no longer accepts `assets_to_preload` (removed in Phase 68).

For overcooked_controllable_demo.py:
- Line 60: `.user_experience(scene_body_filepath=...)` becomes `.content(scene_body_filepath=...)`

Do NOT change any parameter values, only method names and groupings.
  </action>
  <verify>
Run: `python -c "from interactive_gym.examples.cogrid.scenes import controllable_scenes; print('controllable_scenes OK')"` -- should print OK with no errors.
Run: `python -c "from interactive_gym.examples.cogrid import overcooked_controllable_demo; print('demo OK')"` -- should print OK with no errors (may start eventlet but will import).
Run: `grep -n '\.user_experience\|\.pyodide(' interactive_gym/examples/cogrid/scenes/controllable_scenes.py interactive_gym/examples/cogrid/overcooked_controllable_demo.py` -- should return zero matches.
  </verify>
  <done>Both files import without AttributeError. Zero references to .user_experience() or .pyodide() remain in either file. assets_to_preload is in .assets() calls, not .rendering().</done>
</task>

<task type="auto">
  <name>Task 2: Migrate 4 e2e test config files</name>
  <files>
    interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_test.py
    interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_focus_timeout_test.py
    interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_multi_episode_test.py
    interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_scene_isolation_test.py
  </files>
  <action>
Each of the 4 test config files has the same pattern (2 lines to fix per file):

1. `.focus_loss_config(timeout_ms=X, pause_on_partner_background=False)` becomes `.multiplayer(focus_loss_timeout_ms=X, pause_on_partner_background=False)`. Note the parameter rename: `timeout_ms` in old focus_loss_config becomes `focus_loss_timeout_ms` in multiplayer().

2. `.pyodide(input_confirmation_timeout_ms=2000)` becomes `.multiplayer(input_confirmation_timeout_ms=2000)`. Since the previous line's `.multiplayer()` call is now adjacent, these two can be merged into a single `.multiplayer()` call with all params combined. For example:
   ```python
   .multiplayer(focus_loss_timeout_ms=0, pause_on_partner_background=False, input_confirmation_timeout_ms=2000)
   ```

The 4 files to fix:
- `overcooked_human_human_multiplayer_test.py` lines 63-64: focus_loss_config(timeout_ms=0) + pyodide(input_confirmation_timeout_ms=2000)
- `overcooked_human_human_multiplayer_focus_timeout_test.py` lines 72-73: focus_loss_config(timeout_ms=10000) + pyodide(input_confirmation_timeout_ms=2000)
- `overcooked_human_human_multiplayer_multi_episode_test.py` lines 69-70: focus_loss_config(timeout_ms=0) + pyodide(input_confirmation_timeout_ms=2000)
- `overcooked_human_human_multiplayer_scene_isolation_test.py` lines 71-72: focus_loss_config(timeout_ms=0) + pyodide(input_confirmation_timeout_ms=2000)

Also update the comments in each file that reference old method names (e.g., "focus_loss_config(timeout_ms=10000)" in docstrings/comments should say "multiplayer(focus_loss_timeout_ms=10000)").

Do NOT change any parameter values, only method names.
  </action>
  <verify>
Run for each file:
```
python -c "import interactive_gym.examples.cogrid.overcooked_human_human_multiplayer_test" 2>&1 | head -5
python -c "import interactive_gym.examples.cogrid.overcooked_human_human_multiplayer_focus_timeout_test" 2>&1 | head -5
python -c "import interactive_gym.examples.cogrid.overcooked_human_human_multiplayer_multi_episode_test" 2>&1 | head -5
python -c "import interactive_gym.examples.cogrid.overcooked_human_human_multiplayer_scene_isolation_test" 2>&1 | head -5
```
Each should import without AttributeError (they will try to start eventlet server but should not crash on method calls).

Run: `grep -rn '\.focus_loss_config\|\.pyodide(' interactive_gym/examples/cogrid/overcooked_human_human_multiplayer_*test*.py` -- should return zero matches.
  </verify>
  <done>All 4 test config files import without AttributeError. Zero references to .focus_loss_config() or .pyodide() remain. Comments updated to reference new method names.</done>
</task>

</tasks>

<verification>
After both tasks, run a comprehensive check:
1. `grep -rn '\.pyodide\(\|\.user_experience\(\|\.focus_loss_config\(\|\.player_grouping\(\|\.continuous_monitoring\(\|\.exclusion_callbacks\(\|\.reconnection_config\(\|\.partner_disconnect_message_config\(' interactive_gym/examples/` -- should return zero matches (excludes docs/).
2. `python -m pytest tests/unit/ -v` -- all 27 unit tests pass.
3. All migrated files importable without error.
</verification>

<success_criteria>
- Zero references to any removed method name in Python files under interactive_gym/examples/
- All 27 unit tests still pass
- All 6 migrated files import without errors
</success_criteria>

<output>
After completion, create `.planning/phases/70-verification-test-pass/70-01-SUMMARY.md`
</output>
