---
phase: 76-js-naming-clarity
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - interactive_gym/server/static/js/webrtc_manager.js
  - interactive_gym/server/static/js/ui_utils.js
autonomous: true

must_haves:
  truths:
    - "WebRTC abbreviations pc and dc are expanded to peerConnection and dataChannel in ConnectionQualityMonitor, LatencyTelemetry, and _setupDataChannel"
    - "The pgg import alias in ui_utils.js is renamed to a descriptive name"
    - "No JavaScript runtime errors introduced by renames"
  artifacts:
    - path: "interactive_gym/server/static/js/webrtc_manager.js"
      provides: "WebRTC manager with clear variable names"
      contains: "this.peerConnection"
    - path: "interactive_gym/server/static/js/ui_utils.js"
      provides: "UI utilities with clear import alias"
      contains: "import * as phaserGraphics"
  key_links:
    - from: "interactive_gym/server/static/js/ui_utils.js"
      to: "interactive_gym/server/static/js/phaser_gym_graphics.js"
      via: "import alias"
      pattern: "phaserGraphics\\."
    - from: "interactive_gym/server/static/js/webrtc_manager.js"
      to: "RTCPeerConnection API"
      via: "this.peerConnection property"
      pattern: "this\\.peerConnection"
---

<objective>
Rename abbreviated and unclear variable names in WebRTC code and utility imports to improve readability.

Purpose: WebRTC code uses `pc` and `dc` abbreviations that obscure the code's purpose. The `pgg` import alias in ui_utils.js is cryptic. Expanding these to descriptive names makes the code immediately understandable.

Output: Cleaner webrtc_manager.js and ui_utils.js with descriptive names throughout.
</objective>

<execution_context>
@/Users/chasemcd/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chasemcd/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/76-js-naming-clarity/76-RESEARCH.md
@interactive_gym/server/static/js/webrtc_manager.js
@interactive_gym/server/static/js/ui_utils.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand WebRTC abbreviations in webrtc_manager.js</name>
  <files>interactive_gym/server/static/js/webrtc_manager.js</files>
  <action>
Rename abbreviated variables in webrtc_manager.js. There are three distinct rename targets in this file:

**1. `this.pc` in ConnectionQualityMonitor class (line 32):**
The constructor accepts `peerConnection` but stores it as `this.pc`. Rename `this.pc` to `this.peerConnection` throughout the class. Occurrences:
- `this.pc = peerConnection;` (line 32)
- `if (!this.pc || this.pc.connectionState !== 'connected') return;` (line 67)
- `const stats = await this.pc.getStats();` (line 70)

**2. `this.pc` in LatencyTelemetry class (line 911):**
Same pattern - constructor accepts `peerConnection`, stores as `this.pc`. Rename to `this.peerConnection`. Occurrences:
- `this.pc = peerConnection;` (line 911)
- `if (!this.pc || this.pc.connectionState !== 'connected') return;` (line 942)
- `const stats = await this.pc.getStats();` (line 945)

**3. `dc` parameter in `_setupDataChannel` method of WebRTCManager class (line 652):**
The method parameter `dc` should be renamed to `dataChannel`. Occurrences:
- `_setupDataChannel(dc)` (line 652)
- `dc.binaryType = 'arraybuffer';` (line 653)
- `dc.onopen = () => {` (line 655)
- `dc.onmessage = (event) => {` (line 660)
- `dc.onclose = () => {` (line 664)
- `dc.onerror = (error) => {` (line 677)

Also update the JSDoc for `_setupDataChannel`:
- `@param {RTCDataChannel} dc` -> `@param {RTCDataChannel} dataChannel`

Do NOT rename `this.peerConnection` or `this.dataChannel` properties on the WebRTCManager class itself -- those are already well-named (they were named during Phase 74 or earlier).

Use word-boundary-aware find-replace to avoid unintended matches. Verify each replacement by counting occurrences before and after.
  </action>
  <verify>
1. `grep -c 'this\.pc\b' interactive_gym/server/static/js/webrtc_manager.js` returns 0
2. `grep -c '\bdc\b' interactive_gym/server/static/js/webrtc_manager.js` returns 0 (no standalone `dc` references remain)
3. `grep -c 'this\.peerConnection' interactive_gym/server/static/js/webrtc_manager.js` shows increase (ConnectionQualityMonitor + LatencyTelemetry instances added)
4. File has no syntax errors: `node --check interactive_gym/server/static/js/webrtc_manager.js` (or check that the export/import syntax is valid)
5. `python -m pytest tests/unit/ -v` passes (Python tests still work -- verifies no accidental file corruption)
  </verify>
  <done>All `this.pc` references in ConnectionQualityMonitor and LatencyTelemetry are expanded to `this.peerConnection`. The `dc` parameter in `_setupDataChannel` is expanded to `dataChannel`. Zero standalone `pc` or `dc` abbreviations remain in the file.</done>
</task>

<task type="auto">
  <name>Task 2: Rename pgg import alias in ui_utils.js</name>
  <files>interactive_gym/server/static/js/ui_utils.js</files>
  <action>
Rename the cryptic `pgg` import alias to `phaserGraphics` in ui_utils.js. The alias `pgg` presumably stands for "phaser_gym_graphics" but is not self-documenting.

**Import statement (line 1):**
- `import * as pgg  from './phaser_gym_graphics.js';` -> `import * as phaserGraphics  from './phaser_gym_graphics.js';`

**Usage sites (3 occurrences):**
- `pgg.addHumanKeyPressToBuffer(...)` (line 38) -> `phaserGraphics.addHumanKeyPressToBuffer(...)`
- `pgg.updatePressedKeys(pressedKeys, keypressTimestamp);` (line 49) -> `phaserGraphics.updatePressedKeys(pressedKeys, keypressTimestamp);`
- `pgg.updatePressedKeys(pressedKeys);` (line 59) -> `phaserGraphics.updatePressedKeys(pressedKeys);`

Verify no other occurrences of `pgg` exist in the file after replacement.
  </action>
  <verify>
1. `grep -c '\bpgg\b' interactive_gym/server/static/js/ui_utils.js` returns 0
2. `grep -c 'phaserGraphics' interactive_gym/server/static/js/ui_utils.js` returns 4 (1 import + 3 usages)
3. `python -m pytest tests/unit/ -v` passes
  </verify>
  <done>The `pgg` alias is renamed to `phaserGraphics` throughout ui_utils.js. The import and all 3 usage sites reflect the new name. No other files import ui_utils.js as `pgg`.</done>
</task>

</tasks>

<verification>
1. Zero occurrences of `this.pc` (as standalone property) in webrtc_manager.js
2. Zero occurrences of standalone `dc` variable in webrtc_manager.js
3. Zero occurrences of `pgg` in ui_utils.js
4. No new variable names collide with existing names in any modified file
5. `python -m pytest tests/unit/ -v` passes (Python tests verify no accidental file corruption)
6. No JavaScript syntax errors in modified files
</verification>

<success_criteria>
- webrtc_manager.js: `this.pc` expanded to `this.peerConnection` in ConnectionQualityMonitor and LatencyTelemetry; `dc` expanded to `dataChannel` in `_setupDataChannel`
- ui_utils.js: `pgg` expanded to `phaserGraphics`
- All Python tests pass
- No JavaScript syntax errors
</success_criteria>

<output>
After completion, create `.planning/phases/76-js-naming-clarity/76-01-SUMMARY.md`
</output>
