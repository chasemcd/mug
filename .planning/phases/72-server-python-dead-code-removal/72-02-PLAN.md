---
phase: 72-server-python-dead-code-removal
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - interactive_gym/server/game_manager.py
  - interactive_gym/server/admin/aggregator.py
  - interactive_gym/configurations/experiment_config.py
  - interactive_gym/configurations/remote_config.py
  - interactive_gym/server/app.py
  - interactive_gym/server/player_pairing_manager.py
autonomous: true

must_haves:
  truths:
    - "No unused methods remain on GameManager"
    - "No unused methods remain on AdminEventAggregator"
    - "No unused methods or standalone functions remain in experiment_config.py or remote_config.py"
    - "No dead function is_valid_session remains in app.py"
    - "No vestigial logic (commented-out code, duplicate imports, unreachable code) remains in server Python files"
    - "Backward compatibility aliases PlayerPairing/PlayerPairingManager are removed"
    - "All unit tests pass after removals"
  artifacts:
    - path: "interactive_gym/server/game_manager.py"
      provides: "GameManager with only live methods"
    - path: "interactive_gym/server/admin/aggregator.py"
      provides: "AdminEventAggregator with only live methods"
    - path: "interactive_gym/configurations/experiment_config.py"
      provides: "ExperimentConfig with dead to_dict/serialize_dict/is_json_serializable removed"
    - path: "interactive_gym/configurations/remote_config.py"
      provides: "RemoteConfig with dead logging/to_dict/simulate_waiting_room/serialize_dict/is_json_serializable removed"
    - path: "interactive_gym/server/app.py"
      provides: "app.py with commented-out handlers, dead function, and duplicate imports removed"
    - path: "interactive_gym/server/player_pairing_manager.py"
      provides: "player_pairing_manager.py with backward compat aliases removed"
  key_links:
    - from: "interactive_gym/server/game_manager.py"
      to: "interactive_gym/server/player_pairing_manager.py"
      via: "import and type annotation"
      pattern: "PlayerGroupManager"
---

<objective>
Remove all dead methods, dead standalone functions, vestigial logic, and backward compatibility aliases from server Python code.

Purpose: Eliminate dead methods from GameManager (4 methods), AdminEventAggregator (8 methods), ExperimentConfig (3 items), RemoteConfig (5 items), and app.py (1 function). Clean all vestigial logic (commented-out code blocks, duplicate imports, unreachable code, duplicate loops). Remove backward compat aliases and update references.

Output: Leaner server classes with only live code. Zero functionality change.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/72-server-python-dead-code-removal/72-RESEARCH.md

Key reference files:
@interactive_gym/server/game_manager.py
@interactive_gym/server/admin/aggregator.py
@interactive_gym/configurations/experiment_config.py
@interactive_gym/configurations/remote_config.py
@interactive_gym/server/app.py
@interactive_gym/server/player_pairing_manager.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove dead methods and standalone functions</name>
  <files>
    interactive_gym/server/game_manager.py
    interactive_gym/server/admin/aggregator.py
    interactive_gym/configurations/experiment_config.py
    interactive_gym/configurations/remote_config.py
    interactive_gym/server/app.py
  </files>
  <action>
    Remove the following dead methods and functions. For each removal, delete the entire method/function definition including its decorators and docstring. Do NOT change any surrounding code.

    1. **game_manager.py** - Remove these 4 methods from `GameManager`:
       - `_is_rtt_compatible` (line ~381) - never called
       - `_get_waiting_subject_ids` (line ~420) - never called
       - `send_participant_to_waiting_room` (line ~954) - never called
       - `broadcast_waiting_room_status` (line ~975) - never called
       Also: remove the commented-out Game instantiation code (lines ~198-203).
       Also: update the comment on line ~187 that references "RemoteGame" to say "RemoteGameV2" instead.

    2. **aggregator.py** - Remove these 8 methods from `AdminEventAggregator`:
       - `track_participant_game_start` (line ~206) - never called
       - `track_participant_game_end` (line ~232) - never called
       - `archive_active_session` (line ~355) - never called
       - `get_session_detail` (line ~391) - never called
       - `track_wait_complete` (line ~445) - never called
       - `get_participant_detail` (line ~824) - never called
       - `get_session_history_detail` (line ~1220) - never called
       - `stop_broadcast_loop` (line ~1436) - never called
       Also: remove `close_console_log_files` (line ~1312) - only called from dead `stop_broadcast_loop`
       Also: fix/remove the `game.host_id` reference on line ~409 (references non-existent attribute) -- this is inside `archive_active_session` which is being removed entirely, so it goes with the method.

    3. **experiment_config.py** - Remove these items:
       - `to_dict` method on `ExperimentConfig` (only referenced in a comment)
       - `serialize_dict` standalone function (only called from dead `to_dict`)
       - `is_json_serializable` standalone function (only called from dead `serialize_dict`)

    4. **remote_config.py** - Remove these items:
       - `logging` method on `RemoteConfig` (line ~100) - never called
       - `to_dict` method on `RemoteConfig` (line ~457) - never called
       - `simulate_waiting_room` method on `RemoteConfig` (line ~449) - never called
       - `serialize_dict` standalone function (line ~464) - only called from dead `to_dict`
       - `is_json_serializable` standalone function (line ~489) - only called from dead `serialize_dict`

    5. **app.py** - Remove this dead function:
       - `is_valid_session` function (line ~761) - defined but only referenced in comments (all calls are commented out)

    After removing all dead code, clean up any imports in each file that are now unused ONLY because the dead code was removed. Be conservative -- only remove an import if you can confirm it has zero remaining uses in that file.
  </action>
  <verify>
    For each file, grep to confirm the dead methods/functions are gone:
    - `grep -n "_is_rtt_compatible\|_get_waiting_subject_ids\|send_participant_to_waiting_room\|broadcast_waiting_room_status" interactive_gym/server/game_manager.py` returns NO matches
    - `grep -n "track_participant_game_start\|track_participant_game_end\|archive_active_session\|get_session_detail\|track_wait_complete\|get_participant_detail\|get_session_history_detail\|stop_broadcast_loop\|close_console_log_files" interactive_gym/server/admin/aggregator.py` returns NO matches
    - `grep -n "def to_dict\|def serialize_dict\|def is_json_serializable" interactive_gym/configurations/experiment_config.py` returns NO matches
    - `grep -n "def logging\|def to_dict\|def simulate_waiting_room\|def serialize_dict\|def is_json_serializable" interactive_gym/configurations/remote_config.py` returns NO matches
    - `grep -n "def is_valid_session" interactive_gym/server/app.py` returns NO matches
    - `python -c "from interactive_gym.server.app import create_app"` or equivalent import succeeds without error
    - `python -c "from interactive_gym.server.game_manager import GameManager"` succeeds
    - `python -c "from interactive_gym.server.admin.aggregator import AdminEventAggregator"` succeeds
  </verify>
  <done>
    4 dead methods removed from GameManager. 9 dead methods removed from AdminEventAggregator. 3 dead items removed from experiment_config.py. 5 dead items removed from remote_config.py. 1 dead function removed from app.py. All remaining code imports successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Clean vestigial logic and remove backward compat aliases</name>
  <files>
    interactive_gym/server/app.py
    interactive_gym/server/player_pairing_manager.py
    interactive_gym/server/game_manager.py
  </files>
  <action>
    **Vestigial logic cleanup in app.py:**

    1. Remove commented-out `on_connect` SocketIO handler block (lines ~483-501).
    2. Remove commented-out `on_disconnect` SocketIO handler block (lines ~862-896).
    3. Remove commented-out `# return` in `send_pressed_keys` (line ~904).
    4. Remove commented-out `# sess_id = ...` (line ~905).
    5. Remove commented-out `# game = game_manager.get_subject_game(subject_id)` (line ~925).
    6. Remove commented-out print statements (lines ~928-929).
    7. Remove commented-out `is_valid_session` calls and related commented lines (lines ~487, 629, 786, 925, 930, 947). Note: some of these may have been removed by Task 1 when the function was deleted -- remove any remaining commented references.
    8. Remove duplicate `import os` -- keep the FIRST occurrence (line ~6), delete the second (line ~13).
    9. Remove duplicate `from interactive_gym.server import game_manager as gm` -- keep the FIRST occurrence (line ~24), delete the second (line ~29).
    10. Fix the duplicate `tear_down()` loop in `on_exit()` (lines ~1122-1127): there are two identical loops iterating over game managers and calling tear_down(). Remove the duplicate loop, keeping only one.

    NOTE: Line numbers are approximate from the RESEARCH.md and may shift after Task 1 removes `is_valid_session`. Read the file fresh, locate each pattern by content (not line number), and remove.

    **Backward compatibility aliases in player_pairing_manager.py:**

    11. Remove these two lines at the bottom of `interactive_gym/server/player_pairing_manager.py` (lines ~315-316):
        ```python
        PlayerPairing = PlayerGroup
        PlayerPairingManager = PlayerGroupManager
        ```

    12. In `interactive_gym/server/game_manager.py`, update the type annotation on line ~65:
        - Change `pairing_manager: player_pairing_manager.PlayerPairingManager | None = None`
        - To: `pairing_manager: player_pairing_manager.PlayerGroupManager | None = None`

    Run `pytest tests/unit/ -v` to confirm all 27 tests still pass.
  </action>
  <verify>
    - `grep -c "import os" interactive_gym/server/app.py` returns exactly 1
    - `grep -c "import game_manager as gm" interactive_gym/server/app.py` returns exactly 1
    - `grep -n "PlayerPairing" interactive_gym/server/player_pairing_manager.py` returns NO matches
    - `grep -n "PlayerPairingManager" interactive_gym/server/game_manager.py` returns NO matches
    - `grep -n "PlayerGroupManager" interactive_gym/server/game_manager.py` returns at least 1 match
    - `grep -n "is_valid_session" interactive_gym/server/app.py` returns NO matches (neither definition nor commented calls)
    - `pytest tests/unit/ -v` passes (27/27 tests)
  </verify>
  <done>
    All commented-out code blocks removed from app.py. Duplicate imports removed (kept first occurrences). Duplicate tear_down loop removed from on_exit(). Backward compat aliases removed from player_pairing_manager.py and reference updated in game_manager.py. All 27 unit tests pass.
  </done>
</task>

</tasks>

<verification>
- No dead methods remain on GameManager, AdminEventAggregator, ExperimentConfig, or RemoteConfig
- No dead standalone functions remain in experiment_config.py, remote_config.py, or app.py
- No commented-out code blocks remain in app.py
- No duplicate imports remain in app.py
- No duplicate tear_down loop in on_exit()
- No backward compatibility aliases remain
- `pytest tests/unit/ -v` passes with 27/27 tests
- All affected modules import without error
</verification>

<success_criteria>
- 22+ dead methods/functions removed across 5 files
- All vestigial logic cleaned from app.py (commented-out blocks, duplicates, dead references)
- Backward compat aliases removed and references updated
- All 27 unit tests pass
- No import errors in affected modules
</success_criteria>

<output>
After completion, create `.planning/phases/72-server-python-dead-code-removal/72-02-SUMMARY.md`
</output>
