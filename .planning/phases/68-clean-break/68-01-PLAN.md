---
phase: 68-clean-break
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - interactive_gym/scenes/gym_scene.py
  - interactive_gym/server/game_manager.py
  - interactive_gym/server/matchmaker.py
  - tests/unit/test_latency_fifo_integration.py
autonomous: true

must_haves:
  truths:
    - "Calling any of the 9 old method names on a GymScene instance raises AttributeError"
    - "rendering() only accepts 9 display params (no asset params)"
    - "No deprecation aliases or redirect methods exist in the codebase"
    - "All internal references within GymScene use new method names"
    - "Existing unit tests pass (those not calling removed methods)"
  artifacts:
    - path: "interactive_gym/scenes/gym_scene.py"
      provides: "GymScene class with old methods removed and rendering() slimmed"
      contains: "def runtime|def multiplayer|def content|def waitroom|def assets"
      not_contains: "def pyodide|def user_experience|def player_grouping|def continuous_monitoring|def exclusion_callbacks|def reconnection_config|def partner_disconnect_message_config|def focus_loss_config|def player_pairing"
  key_links:
    - from: "interactive_gym/scenes/gym_scene.py"
      to: "rendering() signature"
      via: "9 display params only"
      pattern: "def rendering\\(.*fps.*env_to_state_fn.*hud_text_fn.*rollback_smoothing_duration"
---

<objective>
Remove all 9 old method names from GymScene and slim rendering() by removing asset params.

Purpose: Complete the clean break from old API â€” no aliases, no shims, no backward compat methods.
The new methods (runtime, multiplayer, content, waitroom, assets) were added in Phase 67.
Now we delete the old ones and remove duplicate asset params from rendering().

Output: A GymScene class with ONLY the new API surface.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@interactive_gym/scenes/gym_scene.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove 9 old method definitions and slim rendering()</name>
  <files>interactive_gym/scenes/gym_scene.py</files>
  <action>
Delete the following 9 method definitions entirely from the GymScene class:

1. `pyodide()` method (~lines 732-850) - replaced by runtime() + multiplayer()
2. `user_experience()` method (~lines 495-579) - replaced by content() + waitroom()
3. `player_grouping()` method (~lines 1194-1225) - merged into multiplayer()
4. `continuous_monitoring()` method (~lines 1227-1305) - merged into multiplayer()
5. `exclusion_callbacks()` method (~lines 1307-1342) - merged into multiplayer()
6. `reconnection_config()` method (~lines 1344-1362) - merged into multiplayer()
7. `partner_disconnect_message_config()` method (~lines 1364-1394) - merged into multiplayer()
8. `focus_loss_config()` method (~lines 1396-1437) - merged into multiplayer()
9. `player_pairing()` method (~lines 1440-1452) - was an alias for player_grouping()

Also slim rendering() by removing the 5 asset params that now live in assets():
- Remove `preload_specs` param and its handling block
- Remove `state_init` param and its handling block
- Remove `assets_dir` param and its handling block
- Remove `assets_to_preload` param and its handling block
- Remove `animation_configs` param and its handling block
- Update the docstring to remove references to these 5 removed params

After slimming, rendering() should have exactly 9 params:
fps, env_to_state_fn, hud_text_fn, hud_score_carry_over, location_representation, game_width, game_height, background, rollback_smoothing_duration

DO NOT remove or modify:
- `matchmaking()` method (it is NOT in the removal list)
- `matchmaker` property
- `runtime()` method (new, added in Phase 67)
- `multiplayer()` method (new, added in Phase 67)
- `content()` method (new, added in Phase 67)
- `waitroom()` method (new, added in Phase 67)
- `assets()` method (new, added in Phase 67)
- `environment()`, `policies()`, `gameplay()` methods (unchanged)
- `simulate_waiting_room` property
- `get_complete_scene_metadata()` method
- Any `__init__` attributes (attributes stay, only method definitions are removed)
  </action>
  <verify>
Run: `python -c "from interactive_gym.scenes.gym_scene import GymScene; s = GymScene(); print('Import OK')"` to confirm the module loads.

Run: `python -c "
from interactive_gym.scenes.gym_scene import GymScene
s = GymScene()
# Verify old methods are gone
for name in ['pyodide', 'user_experience', 'player_grouping', 'continuous_monitoring', 'exclusion_callbacks', 'reconnection_config', 'partner_disconnect_message_config', 'focus_loss_config', 'player_pairing']:
    assert not hasattr(s, name) or not callable(getattr(s, name)), f'{name} should not exist as a method'
# Verify new methods exist
for name in ['runtime', 'multiplayer', 'content', 'waitroom', 'assets', 'rendering', 'matchmaking', 'policies', 'gameplay', 'environment']:
    assert hasattr(s, name) and callable(getattr(s, name)), f'{name} should exist'
# Verify rendering() signature has no asset params
import inspect
sig = inspect.signature(s.rendering)
params = list(sig.parameters.keys())
assert 'preload_specs' not in params, 'preload_specs should be removed from rendering'
assert 'state_init' not in params, 'state_init should be removed from rendering'
assert 'assets_dir' not in params, 'assets_dir should be removed from rendering'
assert 'assets_to_preload' not in params, 'assets_to_preload should be removed from rendering'
assert 'animation_configs' not in params, 'animation_configs should be removed from rendering'
assert len(params) == 9, f'rendering() should have 9 params, got {len(params)}: {params}'
print('All checks passed')
"` to confirm methods removed and rendering slimmed.
  </verify>
  <done>
9 old methods deleted from GymScene. rendering() has exactly 9 display params (no asset params).
New methods (runtime, multiplayer, content, waitroom, assets) and matchmaking() remain intact.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update string references in server code and test file</name>
  <files>
interactive_gym/server/game_manager.py
interactive_gym/server/matchmaker.py
tests/unit/test_latency_fifo_integration.py
  </files>
  <action>
Update documentation string references to old method names in server code.
These are NOT method calls -- they are string literals in log messages and docstrings
that reference old API names. Update them to reference the new API names.

1. In `interactive_gym/server/game_manager.py` line ~322:
   The log message says `scene.matchmaking(matchmaker=GroupReunionMatchmaker())`.
   `matchmaking()` is NOT being removed, so this reference is still valid. NO CHANGE NEEDED.

2. In `interactive_gym/server/matchmaker.py` line ~326:
   The docstring example says `.matchmaking(matchmaker=GroupReunionMatchmaker())`.
   `matchmaking()` is NOT being removed. NO CHANGE NEEDED.

3. In `tests/unit/test_latency_fifo_integration.py`:
   The tests call `GymScene().matchmaking(...)` which still exists. NO CHANGE NEEDED.

After reviewing all three files, verify that no changes are actually needed since
`matchmaking()` is the only server-referenced old method and it is NOT being removed.

Also grep the entire codebase (excluding examples/, docs/, build/) for any INTERNAL
code that calls removed methods. Specifically check:
- interactive_gym/server/ directory
- interactive_gym/scenes/ directory (other than gym_scene.py itself)
- tests/ directory

If any internal code (not examples, not docs) calls the 9 removed methods, update
those calls to use the new method names.

DO NOT update:
- Example files in interactive_gym/examples/ (that is Phase 69)
- Documentation in docs/ (out of scope for this milestone)
- Build artifacts in build/ (stale copies)
  </action>
  <verify>
Run grep to confirm no internal code (excluding examples/, docs/, build/) calls removed methods:
`grep -rn "\.pyodide\(\|\.user_experience\(\|\.player_grouping\(\|\.continuous_monitoring\(\|\.exclusion_callbacks\(\|\.reconnection_config\(\|\.partner_disconnect_message_config\(\|\.focus_loss_config\(\|\.player_pairing\(" interactive_gym/scenes/ interactive_gym/server/ tests/ --include="*.py" | grep -v "examples/" | grep -v "docs/" | grep -v "build/" | grep -v "gym_scene.py"`

Expected: No output (no internal callers of removed methods).

Run existing tests: `python -m pytest tests/ -x -q` to confirm nothing is broken.
  </verify>
  <done>
No internal code references removed method names. Server code references to matchmaking()
are unchanged since that method persists. All tests pass.
  </done>
</task>

</tasks>

<verification>
1. `python -c "from interactive_gym.scenes.gym_scene import GymScene; s = GymScene()"` succeeds
2. All 9 old method names raise AttributeError when called on GymScene instance
3. `rendering()` has exactly 9 params (no asset params)
4. `matchmaking()` still works: `GymScene().matchmaking(hide_lobby_count=True)`
5. All new methods work: runtime(), multiplayer(), content(), waitroom(), assets()
6. `python -m pytest tests/ -x -q` passes
7. No internal code references removed methods (grep confirms)
</verification>

<success_criteria>
- CLNB-01 satisfied: All 9 old method names removed, no deprecation aliases
- CLNB-02 satisfied: No backward-compat shims or redirect methods in codebase
- rendering() slimmed from 14 to 9 params per APIC-05
- All existing tests pass
- matchmaking() and all new Phase 67 methods remain functional
</success_criteria>

<output>
After completion, create `.planning/phases/68-clean-break/68-01-SUMMARY.md`
</output>
